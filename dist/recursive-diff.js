!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.recursiveDiff=t():e.recursiveDiff=t()}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t){function o(e){let t=typeof e;return"object"===t&&(e instanceof Array?t="array":e instanceof Date&&(t="date")),t}function n(e,t,o,n){if(!t.match(/^\//))throw new Error(`Diff path: "${t}" is not valid`);const r=t.split("/");r.shift();let i=e;const{length:l}=r;for(let f=0;f<l;f+=1){if(!i)throw new Error(`Invalid path: "${t}" for object: ${JSON.stringify(e,null,2)}`);if(r[f].length<1)throw new Error(`Invalid path: "${t}" for object: ${JSON.stringify(e,null,2)}`);f!==l-1?(i=i[r[f]],n&&n(i)):i[r[f]]=o}return e}function r(e,t){const n=t.split("/");n.shift();let r=e;const{length:i}=n;for(let l=0;l<i;l+=1)if(l!==i-1){if(!r[n[l]])throw new Error(`Invalid path: "${t}" for object: ${JSON.stringify(e,null,2)}`);r=r[n[l]]}else if("object"===o(r))delete r[n[l]];else{const e=parseInt(n[l],10);for(;r.length>e;)r.pop()}return e}e.exports={getDiff:function e(t,n,r,i){let l,f,u,a;const p=o(t),d=o(n);if(null!=r&&"string"==typeof r||(r="/"),null!=i&&"object"==typeof i||(i={}),null==t||null==n)t!==n&&(i[r]="undefined"===p?{operation:"add",value:n}:"undefined"===d?{operation:"delete"}:{operation:"update",value:n});else if(p!==d||"object"!==p&&"array"!==p)t!==n&&(p===d&&"date"===p?t.getTime()!==n.getTime()&&(i[r]={operation:"update",value:n}):i[r]={operation:"update",value:n});else{let p=Object.keys(t);for(let d=0;d<p.length;d+=1)a=p[d],u="/"===r?r+a:`${r}/${a}`,l=t[a],f=n[a],null==l||null==f?l!==f&&(i[u]=void 0===l?{operation:"add",value:f}:void 0===f?{operation:"delete"}:{operation:"update",value:f}):o(l)!==o(f)?i[u]={operation:"update",value:f}:"object"==typeof l?e(l,f,u,i):l!==f&&(i[u]={operation:"update",value:f});p=Object.keys(n);for(let e=0;e<p.length;e+=1)a=p[e],u="/"===r?r+a:`${r}/${a}`,(l=t[a])!==(f=n[a])&&void 0===l&&(i[u]={operation:"add",value:f})}return i},applyDiff:function(e,t,o){let i,l,f;if(!t)throw new Error("No diff object is provided, Nothing to apply");const u=Object.keys(t);for(let a=0;a<u.length;a+=1){const p=u[a];if(i=p,!(f=(l=t[p]).operation).match(/add|update|delete/))throw new Error(`Invalid operation: "${f}"`);if("add"===f){if("/"===i){e=l.value;break}n(e,i,l.value,o)}else if("update"===f){if("/"===i){e=l.value;break}n(e,i,l.value,o)}else{if("/"===i){e=null;break}r(e,i)}}return e}}}])}));